<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>调试表单</title>
</head>
<body>
    <h1>调试表单提交</h1>

    <!-- EdgeForm 嵌入代码 -->
    <div id="edge-form-contact-form"></div>
    <script>
      (function() {
        const formConfig = {
      "formId": "contact-form",
      "fields": [
        {
          "id": "name",
          "type": "text",
          "label": "姓名",
          "required": true
        },
        {
          "id": "email",
          "type": "email",
          "label": "邮箱",
          "required": true
        },
        {
          "id": "message",
          "type": "textarea",
          "label": "留言",
          "required": false
        }
      ]
    };
        const apiBaseUrl = 'https://form.178000.cn';
        const container = document.getElementById('edge-form-contact-form');
        const form = document.createElement('form');
        form.style.maxWidth = '600px';
        form.style.margin = '0 auto';
        form.onsubmit = async (e) => {
          e.preventDefault();
          const formData = new FormData(e.target);
          const data = Object.fromEntries(formData);

          // 调试：显示提交的数据
          console.log('提交的数据:', data);
          document.getElementById('debug').innerHTML = '<h2>提交的数据:</h2><pre>' + JSON.stringify(data, null, 2) + '</pre>';

          const response = await fetch(apiBaseUrl + '/api/submit', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ formId: 'contact-form', submission: data })
          });
          const result = await response.json();
          alert(result.success ? '提交成功！' : '提交失败');
          if (result.success) e.target.reset();
        };
        formConfig.fields.forEach(field => {
          const div = document.createElement('div');
          div.style.marginBottom = '1rem';
          const label = document.createElement('label');
          label.textContent = field.label + (field.required ? ' *' : '');
          label.style.display = 'block';
          label.style.marginBottom = '0.5rem';
          label.style.fontWeight = '500';
          let input;
          if (field.type === 'textarea') {
            input = document.createElement('textarea');
            input.style.minHeight = '100px';
          } else if (field.type === 'select') {
            input = document.createElement('select');
            const defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.textContent = '请选择...';
            input.appendChild(defaultOption);
            if (field.options) {
              field.options.forEach(opt => {
                const option = document.createElement('option');
                option.value = opt;
                option.textContent = opt;
                input.appendChild(option);
              });
            }
          } else {
            input = document.createElement('input');
            input.type = field.type;
          }
          input.name = field.id;
          input.required = field.required;
          if (field.validation) {
            if (field.validation.minLength) input.minLength = field.validation.minLength;
            if (field.validation.maxLength) input.maxLength = field.validation.maxLength;
            if (field.validation.min) input.min = field.validation.min;
            if (field.validation.max) input.max = field.validation.max;
            if (field.validation.pattern) input.pattern = field.validation.pattern;
            if (field.validation.errorMessage) input.title = field.validation.errorMessage;
          }
          input.style.width = '100%';
          input.style.padding = '0.75rem';
          input.style.border = '1px solid #ddd';
          input.style.borderRadius = '8px';
          input.style.fontSize = '1rem';
          div.appendChild(label);
          div.appendChild(input);
          form.appendChild(div);
        });
        const button = document.createElement('button');
        button.type = 'submit';
        button.textContent = '提交';
        button.style.padding = '0.75rem 2rem';
        button.style.background = '#6366f1';
        button.style.color = 'white';
        button.style.border = 'none';
        button.style.borderRadius = '8px';
        button.style.fontSize = '1rem';
        button.style.fontWeight = '500';
        button.style.cursor = 'pointer';
        form.appendChild(button);
        container.appendChild(form);
      })();
    </script>

    <div id="debug" style="margin-top: 2rem; padding: 1rem; background: #f5f5f5; border-radius: 8px;"></div>
</body>
</html>
